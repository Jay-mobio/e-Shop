{% extends 'products/product_header.html' %}
{% load static %}
{% block title  %}Cart{% endblock title %}
{% block content %}
{% include 'products/toolbar.html'  %}
{% include 'products/navbar.html' %}
    <!-- Cart Start -->
    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-lg-8 table-responsive mb-5">
                <table class="table table-light table-borderless table-hover text-center mb-0">
                    <thead class="thead-dark">
                        <tr>
                            <th>Products</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Remove</th>
                        </tr>
                    </thead>
                    {% for i, j  in mylist %}
                    <tbody class="align-middle" id="carttable">
                        <tr class="cart-row">
                            <td class="align-middle"><img src="{{i.product.image.url}}" id="img{{i.product.id}}" alt="" style="width: 100px;">{{i.product.name}}</td>
                            <td class="align-middle cart-price" id="price{{i.product.id}}" id="{{i.product.price}}_id" value="{{i.product.price}}">{{i.product.price}}</td>
                            <td class="align-middle">{{i.quantity}}</td>
                                <td class="align-middle" id="result{{i.product.id}}">{{i.product_total}}</td>
                                <td class="align-middle"><a href="{% url 'customer:remove_item' i.product.id %}"class="btn btn-sm btn-danger">Remove</a>
                                    <button class="btn btn-primary" data-toggle="modal" data-target="#EditCart-{{forloop.counter}}">Edit</button>
                                </td>
                            </tr>
                        </tbody>
                        <!-- Model Starts-->
                        <div class="modal fade" id="EditCart-{{forloop.counter}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">                                
                                </div>
                                <div class="row no-gutters">
                                    <div class="col-md-6 d-flex">
                                        <div class="modal-body p-4 img d-flex">
                                        <img src="{{i.product.image.url}}" alt="" style="width: 200px;">
                                        </div>
                                    </div>
                                    <div class="col-md-6 d-flex">
                                        <div class="modal-body p-5">
                                            <form action="{% url 'customer:update_cart' i.product.id %}" class="code-form">
                                                <div class="text  py-5">
                                                    Name: {{i.product.name}}
                                                    <div style="margin-top:5px ;">
                                                        Quantity
                                                        <select class="form-select" aria-label="Default select example" value="{{i.quantity}}" name="quantity">
                                                            <option selected disabled>{{i.quantity}}</option>
                                                            <option value="1">1</option>
                                                            <option value="2">2</option>
                                                            <option value="3">3</option>
                                                            <option value="3">4</option>
                                                            <option value="3">5</option>
                                                        </select>
                                                    </div>
                                                <div>
                                                <div style="margin-top: 5px;">
                                                    Size :
                                                    <select class="form-select" aria-label="Default select example" name="sub_category" value="{{i.product.sub_category.id}}">
                                                        {% for k in j %}
                                                        <option value="{{k}}">{{k}}</option>
                                                        {% endfor %}

                                                    </select>
                                                </div>
                                                </div>
                                                <div style="margin-top: 5px;">
                                                    <button class="btn btn-primary">Save</button>
                                                </div>  
                                            </form>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                            </div>
                            </div>
                        </div>
                        <!-- Model End -->
                        {% endfor %}
                    </table>
                </div>
                <div class="col-lg-4">
                <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Cart Summary</span></h5>
                <div class="bg-light p-30 mb-5">
                    <div class="border-bottom pb-2">
                        <div class="d-flex justify-content-between mb-3">
                            <h6>Subtotal</h6>
                            <h6 id="subtotal">Rs{{total}}</h6>
                        </div>
                        <div class="d-flex justify-content-between">
                            <h6 class="font-weight-medium">Shipping</h6>
                            <h6 class="font-weight-medium">Free</h6>
                        </div>
                    </div>
                    <div class="pt-2">
                        <div class="d-flex justify-content-between mt-2">
                            <h5>Total</h5>
                            <h5>Rs{{total}}</h5>
                        </div>
                        <a href="{% url 'order:checkout' %}" class="btn btn-block btn-primary font-weight-bold my-3 py-3">Proceed To Checkout</a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    {% include 'products/footer.html' %}
    {% block external_script %}
        <script src="{% static 'js/livetotal.js' %}"></script>
    {% endblock external_script %}
{% endblock %}